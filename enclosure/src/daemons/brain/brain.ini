[brain]
sleep-time = 20:00
wakeup-time = 07:00


[synapses]
kalliope-state = enclosure
control-rotary = enclosure
control-button = enclosure
volume-rotary = enclosure, sonos
volume-button = enclosure, sonos
rfid = enclosure, brickies


[enclosure:components]
control = hal9000.plugins.brain.enclosure.control.Control
volume = hal9000.plugins.brain.enclosure.volume.Volume
motion = hal9000.plugins.brain.enclosure.motion.Motion
rfid = hal9000.plugins.brain.enclosure.rfid.RFID

[enclosure:control]
menu-file = menu/de.ini

[enclosure:volume]
initial-volume = 50
initial-mute = False
volume-minimum = 0
volume-maximum = 100
volume-step = 5


[trigger:kalliope-state]
module = hal9000.plugins.brain.mqtt
mqtt-topic = "kalliope/brain/state"
mqtt-payload-regex = "(?P<state>\w+)"
neuron-json-formatter = '{"kalliope": {"state": "%(state)s"}}'

[trigger:control-rotary]
module = hal9000.plugins.brain.mqtt
mqtt-topic = "hal9000/enclosure/rotary/control/event"
mqtt-payload-regex = "rotary:control delta=(?P<control>[+-]\d+)"
neuron-json-formatter = '{"control": {"delta": "%(control)s"}}'

[trigger:control-button]
module = hal9000.plugins.brain.mqtt
mqtt-topic = "hal9000/enclosure/button/control-select/event"
mqtt-payload-regex = "button:control-select status=(?P<select>\w+)"
neuron-json-formatter = '{"control": {"select": "%(select)s"}}'

[trigger:volume-rotary]
module = hal9000.plugins.brain.mqtt
mqtt-topic = "hal9000/enclosure/rotary/volume/event"
mqtt-payload-regex = "rotary:volume delta=(?P<volume>[+-]?\d+)"
neuron-json-formatter = '{"volume": {"delta": "%(volume)s"}}'

[trigger:volume-button]
module = hal9000.plugins.brain.mqtt
mqtt-topic = "hal9000/enclosure/toggle/volume-mute/event"
mqtt-payload-regex = "toggle:volume-mute status=(?P<mute>\w+)"
neuron-json-formatter = '{"volume": {"mute": "%(mute)s"}}'

[trigger:rfid]
module = hal9000.plugins.brain.mqtt
mqtt-topic = "hal9000/enclosure/rfid/brickies/event"
mqtt-payload-regex = "rfid:brickies (?P<event>\w+)=(?P<uid>\w{8})"
neuron-json-formatter = '{"rfid": {"event": "%(event)s","uid": "%(uid)s"}}'


[action:enclosure]
module = hal9000.plugins.brain.enclosure
kalliope-state = signal:kalliope
enclosure-control = signal:control
enclosure-select = signal:select
enclosure-volume = signal:volume
enclosure-mute = signal:mute

[action:sonos]
module = hal9000.plugins.brain.sonos
sonos-name = Arbeitszimmer
sonos-ip = 192.168.3.30
sonos-volume = jsonpath:signal:$.volume.delta
sonos-mute = jsonpath:signal:$.volume.mute

[action:brickies]
module = hal9000.plugins.brain.brickies
brickies-server-url = http://192.168.4.1/brickies-agent
brickies-reader-service = hal9000
brickies-reader-name = iot-pi0-hal9000
brickies-card-event = jsonpath:signal:$.rfid.event
brickies-card-uid = jsonpath:signal:$.rfid.uid

[action:mqtt]
module = hal9000.plugins.brain.mqtt


[alsa:PCH]
cardindex = 1
control = Master
range-raw-minimum = 27
range-raw-maximum = 87

[alsa:seeed2micvoicec]
cardindex = 0
control = Playback
range-raw-minimum = 100
range-raw-maximum = 220


[mqtt]
server = 127.0.0.1
port = 1883

[python]
module-paths = "../../package", "./package"

[loggers]
keys = root, brain

[handlers]
keys=stdout

[formatters]
keys=stdout

[logger_root]
level=DEBUG
handlers=stdout

[logger_brain]
level=DEBUG
handlers=stdout
qualname=brain
propagate=0

[handler_stdout]
class=StreamHandler
formatter=stdout
args=(sys.stdout,)

[formatter_stdout]
format=%(asctime)s - %(levelname)-8s - %(threadName)-10s - %(name)-10s - %(message)s
datefmt=

